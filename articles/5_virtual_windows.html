<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Virtual windows </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Virtual windows ">
    <meta name="generator" content="docfx 2.10.2.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
              <h1 id="virtual-windows">Virtual windows</h1>
              
<p>You can think of virtual windows as of transparent windows. The user won&#39;t see them and only your application and 
Interaction Engine would know about their existence. Virtual windows could be either Free floating or Z-linked.</p>
<h2 id="virtualwindowsagent">VirtualWindowsAgent</h2>
<p>With VirtualWindowsAgent you can create or delete virtual windows.</p>
<pre><code class="lang-csharp">var host = new Host();
var virtualWindowsAgent = host.InitializeVirtualWindowsAgent();
</code></pre><h2 id="free-floating-virtual-windows">Free floating virtual windows</h2>
<p>Free floating virtual window from Interaction Engine point of view behaves like top most window. Consider this code:</p>
<pre><code class="lang-csharp">var myFreeFloatingWindow = virtualWindowsAgent.CreateFreeFloatingVirtualWindowAsync(
    &quot;MyFreeFloatingWindow&quot;,
    new Rect {
        X = 0,
        Y = 0,
        Height = 200,
        Width = 200
    }).Result;
</code></pre><p>This will create a free floating virtual window in top left corner. Because creation of virtual windows is
asynchronous code we are getting Result of async operation. You most probably would use async/await.</p>
<p>Now we can create interactors for that window like you would do for the normal one:</p>
<pre><code class="lang-csharp">var unboundAgent = host.InitializeUnboundAgent(myFreeFloatingWindow.Id);
unboundAgent
    .AddInteractorFor(new Rect {X = 0, Y =, Width = 200, Height = 200})
    .WithGazeAware()
    .HasGaze(() =&gt; Console.WriteLine(&quot;Hello! I am on Virtual Window!&quot;))
    .LostGaze(() =&gt; Console.WriteLine(&quot;Bye! Do not forget where Virtual window is to look back! :)&quot;));
</code></pre><p>Notice how we created InteractorAgent using newly created virtual window id as <em>defaultWindowId</em> parameter.
This means that all interactors created with this InteractorAgent will be bound to our virtual window by default!</p>
<p>We have mentioned that Interaction engine treats free floating virtual windows as topmost. This mean when you
will create other free floating virtual window with the same bounds it will cover and hide &quot;myFreeFloatingWindow&quot;.
You can change that by setting other than default parameter for Z order when you create virtual window.</p>
<p>Last thing to consider when you create a virtual window is nonOccluding parameter specifying whether virtual
window should occlude or not windows beneath it or not.</p>
<h2 id="z-linked-virtual-windows">Z-linked virtual windows</h2>
<p>Consider this code:</p>
<pre><code class="lang-csharp">var myZLinkedVirtualWindow = host
                .CreateZLinkedVirtualWindowAsync(
                    &quot;MyZLinkedVirtualWindow&quot;,
                    new Rect {X = 0, Y = 0, Width = 200, Height = 200},
                    Process.GetCurrentProcess().MainWindowHandle.ToString())
                .Result;
</code></pre><p>It will create Z-linked virtual window connected to your application&#39;s main window by Z-order. It means this
window will have Z-order value of the main window + 1. When main window will change its Z-order by becoming
foreground or will be minimized or will move behind because some other window will appear in front of it, 
this virtual window will always follow. </p>
<p>If you check properties of z-linked virtual window you will see that it has <em>Id</em> and <em>WindowId</em>. Make sure that
when you create interactors which will be hosted by virtual window always use <em>Id</em> of that window and not <em>WindowId</em>.</p>
<h2 id="resizing-and-moving">Resizing and moving</h2>
<p>You can move or resize virtual windows you have created by changing their bounds:</p>
<pre><code class="lang-csharp">myFreeFloatingWindow.SetBounds(new Rect { X = 0, Y = 0, Width = 1000, Height = 1000 });
</code></pre><p>After setting bounds, your changes will be automatically propagated to Interaction Engine by Unified Foundation.</p>
<h2 id="removing">Removing</h2>
<p>You can remove virtual windows you have created explicitly by using VirtualWindowsAgent:</p>
<pre><code class="lang-csharp">virtualWindowsAgent.DeleteVirtualWindow(myFreeFloatingWindow.Id);
virtualWindowsAgent.DeleteVirtualWindow(myZLinkedVirtualWindow.Id);
</code></pre><p>All virtual window will be also deleted by Interaction Engine when you application will be disconnected.</p>

            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2015-2016 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
